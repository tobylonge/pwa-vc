$(document).ready(function(){app={config:{tabletViewportSize:1024,$singleMenu:$(".single-menu > a"),$loggedInMenu:$(".loggedin-menu"),$tabSearch:$(".tab-search > a"),$searchForm:$("li.search-form"),$disableMenuSet:$(),$jumbotronContainer:$(".jumbotron-container"),$introMessage:$(".intro-message"),$searchBox:$(".search-box"),$menuExpanded:$(".menu-expanded"),$menuCollapsed:$(".menu-collapsed"),typeValues:["Restaurants","Banquet Halls","Local Businesses","Hotels","Spas","Shopping Malls","Cinemas","Painters","Car Dealers"],typeCursorOrientation:"vertical",$advertContainer:$(".advert-container"),$footerBanner:$(".footer-banner"),$jSearchTerm:$(".jsearchterm"),$searchTerm:$(".searchterm"),$jSearchLocation:$(".jsearchlocation"),$searchLocation:$(".searchlocation"),$jSearchTermInput:$(".jsearchterm.tt-input"),$searchTermInput:$(".searchterm.tt-input"),$jSearchLocationInput:$(".jsearchlocation.tt-input"),$searchLocationInput:$(".searchlocation.tt-input"),$lazyImage:$(".lazy"),$loader:$(".loading"),$loaderParent:$(".loading-container"),$copyTextButton:$(".copybutton"),$copyText:$(".copytext"),zClipSwfPath:"js/vendor/ZeroClipboard.swf",$forumList:$(".forum-list"),$forumListItem:$(".forum-list li"),$backToForums:$(".back-forums"),$careerListContainer:$(".career-list-container"),$careerApplyButton:$(".career-list-container a.apply-btn"),$applyForm:$("#apply-form"),$imageThumbnail:$(".th"),termsURL:"../test.json",locationsURL:"../test.json"},init:function(e){if($.extend(app.config,e),jQuery().foundation&&(Foundation.libs.abide.settings.patterns.password=/(?=^.{0,}$)[a-zA-Z0-9-\W+]+$/,Foundation.libs.abide.settings.patterns.email=/[-0-9a-zA-Z.+_]+@[-0-9a-zA-Z.+_]+\.[a-zA-Z]{2,4}/,$(document).foundation()),cf=app.config,cf.$disableMenuSet.add(cf.$singleMenu).add(cf.$loggedInMenu).add(cf.$tabSearch),cf.$disableMenuSet.on("click",function(e){e.preventDefault()}),$(cf.$tabSearch).on("click",function(){cf.$searchForm.toggle()}),$(window).on("resize",app.onWindowResize),jQuery().changeText&&cf.$jumbotronContainer.length>0&&cf.$introMessage.changeText({changeValues:cf.typeValues,cursorOrientation:cf.typeCursorOrientation}),"undefined"!=typeof skrollr){var a=skrollr.init();Modernizr.touch&&a.destroy()}app.showMenu(),jQuery().waypoint&&(cf.$searchBox.waypoint(app.searchBoxWaypoint),cf.$advertContainer.waypoint("sticky")),jQuery().unveil&&cf.$lazyImage.unveil(),$.fn.vcLoader=function(e,a){return app.initLoader(this,e,a)},jQuery().zclip&&cf.$copyTextButton.zclip({path:cf.zClipSwfPath,copy:cf.$copyText.val(),afterCopy:function(){app.notifyMe("The link has been copied to your clipboard.")}}),"undefined"!=typeof Bloodhound&&app.initBloodHound(),$(document).on("scroll",app.onDocumentScroll),app.initForumList(),"undefined"!=typeof Dropzone&&app.initDropzone(),app.initCareerList(),jQuery().swipebox&&cf.$imageThumbnail.swipebox()},onWindowResize:function(){app.config.$searchForm.css("display","")},onDocumentScroll:function(){if(cf=app.config,cf.$advertContainer.length>0){var e=$(window).scrollTop(),a=cf.$advertContainer.offset().top,t=cf.$footerBanner.offset().top;distance=a-e,topbarHeight=55,cf.$advertContainer.hasClass("stuck")?(stuckHeight=$(".stuck").height(),t-(a+stuckHeight)>-distance?cf.$advertContainer.css("padding-top",-distance+topbarHeight):(cf.$advertContainer.css("padding-top",t-(a+stuckHeight+topbarHeight)),console.log("padding-top when reaching footer: "+(t-(a+stuckHeight+topbarHeight))))):cf.$advertContainer.css("padding-top","")}},showMenu:function(){cf=app.config,cf.$searchBox.length>0&&$(window).width()>=cf.tabletViewportSize&&(cf.$menuExpanded.show(),cf.$menuCollapsed.hide())},searchBoxWaypoint:function(e){cf=app.config,"down"===e?($(window).width()>=cf.tabletViewportSize&&(cf.$menuExpanded.hide(),cf.$menuCollapsed.fadeIn(500)),cf.$jSearchTermInput.is(":focus")&&(cf.$searchTermInput.focus(),cf.$jSearchTerm.typeahead("close"),cf.$searchLocation.typeahead("close"),cf.$jSearchLocation.typeahead("close")),cf.$jSearchLocationInput.is(":focus")&&(cf.$searchLocationInput.focus(),cf.$jSearchLocation.typeahead("close"),cf.$searchTerm.typeahead("close"),cf.$jSearchTerm.typeahead("close"))):"up"===e&&($(window).width()>=cf.tabletViewportSize&&(cf.$menuCollapsed.hide(),cf.$menuExpanded.fadeIn(500)),cf.$searchTermInput.is(":focus")&&(cf.$jSearchTermInput.focus(),cf.$searchTerm.typeahead("close"),cf.$searchLocation.typeahead("close"),cf.$jSearchLocation.typeahead("close")),cf.$searchLocationInput.is(":focus")&&(cf.$jSearchLocationInput.focus(),cf.$searchLocation.typeahead("close"),cf.$searchTerm.typeahead("close"),cf.$jSearchTerm.typeahead("close")))},initLoader:function(e,a,t){cf=app.config,"undefined"!=typeof e&&(cf.$loaderParent=$(e),cf.$loaderParent.append('<div class="loading"></div>'),"undefined"!=typeof t&&t&&cf.$loaderParent.addClass("loading-container"),cf.$loader=$(e).find("div.loading"),"string"==typeof a&&app.runLoader(a))},runLoader:function(e){cf=app.config,"show"===e?cf.$loader.fadeIn():"hide"===e&&cf.$loader.fadeOut()},notifyMe:function(e){$("#notificationModal .modal-content").html(e),$("#notificationModal").foundation("reveal","open")},initBloodHound:function(){cf=app.config;var e=new Bloodhound({datumTokenizer:function(e){return Bloodhound.tokenizers.whitespace(e.label)},queryTokenizer:Bloodhound.tokenizers.whitespace,limit:10,remote:{url:cf.termsURL}});e.initialize(),cf.$searchTerm.typeahead(null,{displayKey:"label",source:e.ttAdapter()}).on("typeahead:selected",function(e,a){selectedTTerm(a)}),cf.$jSearchTerm.typeahead(null,{displayKey:"label",source:e.ttAdapter()}).on("typeahead:selected",function(e,a){selectedJTerm(a)});var a=new Bloodhound({datumTokenizer:function(e){return Bloodhound.tokenizers.whitespace(e.label)},queryTokenizer:Bloodhound.tokenizers.whitespace,limit:10,remote:{url:cf.locationsURL}});a.initialize(),cf.$searchLocation.typeahead(null,{displayKey:"label",source:a.ttAdapter()}).on("typeahead:selected",function(e,a){selectedTLocation(a)}),cf.$jSearchLocation.typeahead(null,{displayKey:"label",source:a.ttAdapter()}).on("typeahead:selected",function(e,a){selectedJLocation(a)});var t=2;$jInputs=cf.$jSearchTermInput.add(cf.$jSearchLocationInput),$tInputs=cf.$searchTermInput.add(cf.$searchLocationInput),$jInputs.on("keypress paste",function(){t=1}),$tInputs.on("keypress paste",function(){t=2}),cf.$jSearchTermInput.on("blur",function(){1===t?(cf.$searchTerm.typeahead("val",cf.$jSearchTermInput.val()),cf.$searchTerm.typeahead("close")):(cf.$jSearchTerm.typeahead("val",cf.$searchTermInput.val()),cf.$jSearchTerm.typeahead("close"))}),cf.$jSearchLocationInput.on("blur",function(){1===t?(cf.$searchLocation.typeahead("val",cf.$jSearchLocationInput.val()),cf.$searchLocation.typeahead("close")):(cf.$jSearchLocation.typeahead("val",$(cf.$searchLocationInput).val()),cf.$jSearchLocation.typeahead("close"))}),cf.$searchTermInput.on("blur",function(){2===t?(console.log(cf.$searchTermInput.val()),cf.$jSearchTerm.typeahead("val",cf.$searchTermInput.val()),cf.$jSearchTerm.typeahead("close")):(cf.$searchTerm.typeahead("val",cf.$jSearchTermInput.val()),cf.$searchTerm.typeahead("close"))}),cf.$searchLocationInput.on("blur",function(){2===t?(cf.$jSearchLocation.typeahead("val",cf.$searchLocationInput.val()),cf.$jSearchLocation.typeahead("close")):(cf.$searchLocation.typeahead("val",cf.$jSearchLocationInput.val()),cf.$searchLocation.typeahead("close"))})},initForumList:function(){cf=app.config,cf.$forumList.length>0&&(cf.$forumListItem.on("click",function(e){e.preventDefault(),$(".forum-2 .forumid").val($(this).data("forumid")),$(".forum-2 .forum-date").html($(this).find(".forum-date").html()),$(".forum-2 .forum-address").html($(this).find(".forum-address").html()),$(".forum-2 .forum-time").html($(this).find(".forum-time").html()),$(".forum-1").fadeOut(function(){$(".forum-2").fadeIn()})}),cf.$backToForums.on("click",function(e){e.preventDefault(),$(".forum-2").fadeOut(function(){$(".forum-1").fadeIn()})}))},initDropzone:function(){cf=app.config,pTemplate='<div class="dz-preview dz-file-preview">',pTemplate+='<div class="dz-details">',pTemplate+='<div class="dz-filename"><span data-dz-name></span></div>',pTemplate+='<div class="dz-size" data-dz-size></div>',pTemplate+="<img data-dz-thumbnail />",pTemplate+="</div>",pTemplate+='<div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>',pTemplate+='<div class="dz-success-mark"><span class="icon-ok"></span></div>',pTemplate+='<div class="dz-error-mark"><span class="icon-cancel"></span></div>',pTemplate+='<div class="dz-error-message"><span data-dz-errormessage></span></div>',pTemplate+="</div>";var e=function(e){return temp='<div class="edit-preview">',temp+='<div class="edit-thumb-container">',temp+='<img class="edit-thumb" src="'+e.fileThumbUrl+'" alt="thumb">',temp+="</div>",temp+='<div class="edit-details-container">',temp+='<input type="text" data-original="'+e.fileName+'" placeholder="Image Caption">',temp+='<textarea name="" id="" cols="30" rows="10" data-original="'+e.fileName+'" placeholder="Write image description here..."></textarea>',temp+="</div>",temp+="</div>"};Dropzone.autoDiscover=!1;var a=!1,t=[],o=new Dropzone("#add-photo",{acceptedFiles:"image/*",previewTemplate:pTemplate,maxFilesize:1,init:function(){this.on("complete",function(e){console.log(o.files),console.log(t),"OK"==e.xhr.statusText&&(a=!0),0===this.getUploadingFiles().length&&0===this.getQueuedFiles().length&&(a?$("#addPhotoModal .btn-box").show():app.notifyMe("Sorry there was an issue uploading files. Please try again later."))}),this.on("thumbnail",function(e,a){t.push({fileName:e.name,fileThumbUrl:a})}),$("#addPhotoModal .edit-btn").on("click",function(){t.forEach(function(a){$(".add-photo-2").append(e(a))}),$(".add-photo-1").hide(),$(".add-photo-2").fadeIn(),$("#addPhotoModal .btn-box").hide(),$("#addPhotoModal .save-btn-box").fadeIn()})}});$("#addPhotoModal").on("closed",function(){o.removeAllFiles(),a=!1,t=[],$("#addPhotoModal .btn-box").hide(),$("#addPhotoModal .save-btn-box").hide()})},initCareerList:function(){cf=app.config,cf.$careerListContainer.length>0&&cf.$careerApplyButton.on("click",function(e){e.preventDefault(),$content=$(this).parent("div.content"),jobid=$content.data("jobid"),$heading=$content.find("h3").html(),$(".jobid",cf.$applyForm).val(jobid),$("h3",cf.$applyForm).html($heading),cf.$applyForm.siblings().removeClass("active").end().addClass("active")})}},app.init()});